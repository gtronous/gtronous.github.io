---
layout: post
title: CSCTF2024
date: 2024-09-02 14:31 +0100
categories: [ctf]
tag : [forensics, rev]
image: /assets/ctf/csctf/logo.png
---
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
A deep dive into the latest CyberSpace CTF event, featuring comprehensive writeups on every forensics challenge and two exciting reverse engineering mobile challenges. Big shoutout to the amazing authors and organizers who made this CTF possible—your creativity and effort drive our passion for cybersecurity !

## Social Distancing [Forensics]

Solves: `156` Points: `50` Author: `RJCyber`

Description: `We all remember the time of social distancing and quarantines. How about some quarantined malware? Bet you can't understand what it entails!`

<a href="/assets/zip/csctf/handout_social-distancing.zip" class="btn btn-primary" download>
  <i class="fas fa-download"></i> handout_social-distancing.zip
</a>

<br>

The challenge provides a zip file containing Windows Defender artifact, which is the Quarantine folder where all quarantined files reside :

```
└─$ zipinfo handout_social-distancing.zip   
Archive:  handout_social-distancing.zip
Zip file size: 2900 bytes, number of entries: 8
drwx---     2.0 fat        0 b- stor 24-Aug-26 22:20 Quarantine/Entries/
-rw-a--     2.0 fat      390 b- stor 24-Aug-26 22:17 Quarantine/Entries/{80008A1B-0000-0000-7091-E5797219933B}
drwx---     2.0 fat        0 b- stor 24-Aug-26 22:20 Quarantine/ResourceData/
drwx---     2.0 fat        0 b- stor 24-Aug-26 22:20 Quarantine/ResourceData/95/
-rw-a--     2.0 fat     1166 b- stor 24-Aug-26 22:17 Quarantine/ResourceData/95/957997B71FBF912F2A3E881A13A83E0FAB3ECB47
drwx---     2.0 fat        0 b- stor 24-Aug-26 22:20 Quarantine/Resources/
drwx---     2.0 fat        0 b- stor 24-Aug-26 22:20 Quarantine/Resources/95/
-rw-a--     2.0 fat      108 b- stor 24-Aug-26 22:17 Quarantine/Resources/95/957997B71FBF912F2A3E881A13A83E0FAB3ECB47
8 files, 1664 bytes uncompressed, 1664 bytes compressed:  0.0%
```
Since Windows Defender uses RC4 encryption for the quarantine using a key, it is convenient to decrypt it using a simple script. I personally use this one from https://github.com/knez/defender-dump.

I proceed by placing the Quarantine folder inside my VM's C drive in C:\ProgramData\Microsoft\Windows Defender\ and run the script.
```
C:\Users\vboxuser\Desktop\forensic>python defender-dump/defender-dump.py -d C:\
Exporting test.ps1
File 'quarantine.tar' successfully created
```
We get a powershell file called test.ps1, the content seem to be base64 encoded.
```
$hidden = @"
UEsDBAoAAAAAAOCYuCg8z1FoRAAAAEQAAAAJABwAZWljYXIuY29tVVQJAAOUYCw5y1zNZnV4CwAB
BAAAAAAEAAAAAFg1TyFQJUBBUFs0XFBaWDU0KFBeKTdDQyk3fSRFSUNBUi1TVEFOREFSRC1BTlRJ
VklSVVMtVEVTVC1GSUxFISRIK0gqUEsDBAoAAAAAAE8HG1mJ3nc0MQAAADEAAAAEABwAZmxhZ1VU
CQAD9VzNZtVczWZ1eAsAAQQAAAAABAAAAABDU0NURnt5MHVfdW4tcXU0cmFudDFuM2RfbXlfc2Ny
MVB0IV8weDkxYTNlZGZmNn0KUEsBAh4DCgAAAAAA4Ji4KDzPUWhEAAAARAAAAAkAGAAAAAAAAQAA
AKSBAAAAAGVpY2FyLmNvbVVUBQADlGAsOXV4CwABBAAAAAAEAAAAAFBLAQIeAwoAAAAAAE8HG1mJ
3nc0MQAAADEAAAAEABgAAAAAAAEAAACkgYcAAABmbGFnVVQFAAP1XM1mdXgLAAEEAAAAAAQAAAAA
UEsFBgAAAAACAAIAmQAAAPYAAAAAAA==
"@

$decodedBytes = [System.Convert]::FromBase64String($hidden)

$zipFilePath = "malicious.zip"
[System.IO.File]::WriteAllBytes($zipFilePath, $decodedBytes)

Write-Output "File saved as $zipFilePath"
```
decoding it on host machine reveals the flag.
```
└─$ echo "UEsDBAoAAAAAAOCYuCg8z1FoRAAAAEQAAAAJABwAZWljYXIuY29tVVQJAAOUYCw5y1zNZnV4CwAB      
BAAAAAAEAAAAAFg1TyFQJUBBUFs0XFBaWDU0KFBeKTdDQyk3fSRFSUNBUi1TVEFOREFSRC1BTlRJ
VklSVVMtVEVTVC1GSUxFISRIK0gqUEsDBAoAAAAAAE8HG1mJ3nc0MQAAADEAAAAEABwAZmxhZ1VU
CQAD9VzNZtVczWZ1eAsAAQQAAAAABAAAAABDU0NURnt5MHVfdW4tcXU0cmFudDFuM2RfbXlfc2Ny
MVB0IV8weDkxYTNlZGZmNn0KUEsBAh4DCgAAAAAA4Ji4KDzPUWhEAAAARAAAAAkAGAAAAAAAAQAA
AKSBAAAAAGVpY2FyLmNvbVVUBQADlGAsOXV4CwABBAAAAAAEAAAAAFBLAQIeAwoAAAAAAE8HG1mJ
3nc0MQAAADEAAAAEABgAAAAAAAEAAACkgYcAAABmbGFnVVQFAAP1XM1mdXgLAAEEAAAAAAQAAAAA
UEsFBgAAAAACAAIAmQAAAPYAAAAAAA=="|base64 -d
PK
���(<�QhDD      eicar.comUT     �`,9�\�fux
                                          X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*PK
O��w411flagUT   �\�f�\�fux
                          CSCTF{y0u_un-qu4rant1n3d_my_scr1Pt!_0x91a3edff6}
PK
���(<�QhDD      ▒��eicar.comUT�`,9ux
                                    PK
O��w411▒���flagUT�\�fux
                       PK��
```
Flag: `CSCTF{y0u_un-qu4rant1n3d_my_scr1Pt!_0x91a3edff6}`

## Geometry Dash 2.1 [Forensics]

Solves: `144` Points: `50` Author: `quasar098`

Description: `I would give you the flag but I can't let go (haha get it). use GDBrowser for the last step btw.`

<a href="/assets/zip/csctf/handout_social-distancing.zip" class="btn btn-primary" download>
  <i class="fas fa-download"></i> handout_social-distancing.zip
</a>

<br>

The challenge provides a CCLocalLevels.dat file, which is a file used by Geometry Dash to store data about custom levels that the player has created or downloaded. This file contains various pieces of information, including:
- Level Data: Information about the layout, objects, and obstacles in a custom level.
- Metadata: Details such as the level's name, description, creator, and the level ID.
- Player Progress: The player's progress in these custom levels, including completion status and scores.

I start by decrypting the file using this python script from this github gist https://gist.github.com/FaltoGH/b7563b425e10de41c56bf7af0dc4c864
The resulting file is in xml format, opening the file on notepad reveals some base64 encoded information, so i head out to CyberChef for conveniency and try to decypher the messages.

![alt text](../assets/ctf/csctf/cyberchef.png)

It reveals some interesting information.
```
flag is in the level somewhere
the text below consists of multiple text objects
perhapstry95484635
stop playing the game!
CSCTFa52de5
```

Heading into GDBrowser with the revealed information, i try to query for the 95484635 id in search bar.

![alt text](../assets/ctf/csctf/gdbrowser1.png)

It seems to be a level made by CSCTFa52de5, checking the comments section reveals the flag.

![alt text](../assets/ctf/csctf/gdbrowser2.png)

Flag: `CSCTF{geometry_dash_d0895c120d671b}`